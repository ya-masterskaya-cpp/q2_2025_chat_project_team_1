<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IRC-Chat: IRCDBWrapper ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î IRC-—á–∞—Ç–∞</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IRC-Chat<span id="projectnumber">&#160;Release</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__r_e_a_d_m_e__db__wrapper.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">IRCDBWrapper ‚Äî —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î IRC-—á–∞—Ç–∞</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md0"></a></p>
<h1><a class="anchor" id="autotoc_md1"></a>
üìù –û–ø–∏—Å–∞–Ω–∏–µ</h1>
<p><code><a class="el" href="class_i_r_c_d_b_wrapper.html" title="–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö IRC, –≤–∫–ª—é—á–∞—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏,...">IRCDBWrapper</a></code> ‚Äî —ç—Ç–æ –≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –æ–±—ë—Ä—Ç–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö IRC-—á–∞—Ç–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î <em>–±–µ–∑ –ø—Ä—è–º–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º –∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º</em>. <br  />
 –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –±—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç, –ø—Ä–æ—Å—Ç–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –∏ —á–∏—Å—Ç—ã–π API –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ª–æ–≥–∏–∫–∏.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md3"></a>
üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h1>
<div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="db__wrapper_8h.html">db_wrapper.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span>* conn_str = std::getenv(<span class="stringliteral">&quot;IRC_CHAT_DB_URL&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!conn_str) {</div>
<div class="line">    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Environment variable IRC_CHAT_DB_URL is not set!&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="class_i_r_c_d_b_wrapper.html">IRCDBWrapper</a> db(conn_str);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</span></div>
<div class="line"><span class="keyword">auto</span> [ok, err] = db.AddUserToDB(<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;hashed_password&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (!ok) std::cout &lt;&lt; <span class="stringliteral">&quot;–û—à–∏–±–∫–∞: &quot;</span> &lt;&lt; err &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏–º—è -&gt; —Ö–µ—à)</span></div>
<div class="line"><span class="keyword">auto</span> users = db.GetAllUsers();</div>
<div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; [name, hash] : users) {</div>
<div class="line">    std::cout &lt;&lt; name &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; hash &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="ttc" id="aclass_i_r_c_d_b_wrapper_html"><div class="ttname"><a href="class_i_r_c_d_b_wrapper.html">IRCDBWrapper</a></div><div class="ttdoc">–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö IRC, –≤–∫–ª—é—á–∞—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏,...</div><div class="ttdef"><b>Definition</b> db_wrapper.h:21</div></div>
<div class="ttc" id="adb__wrapper_8h_html"><div class="ttname"><a href="db__wrapper_8h.html">db_wrapper.h</a></div><div class="ttdoc">–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∫–ª–∞—Å—Å–∞ IRCDBWrapper, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω...</div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md5"></a>
üõ†Ô∏è –ú–µ—Ç–æ–¥—ã –∫–ª–∞—Å—Å–∞</h1>
<h2><a class="anchor" id="autotoc_md6"></a>
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h2>
<ul>
<li><b><code>AddUserToDB(const std::string&amp; name, const std::string&amp; pass_hash)</code></b> <br  />
 –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–º—è, —Ö–µ—à –ø–∞—Ä–æ–ª—è). <br  />
 –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code>{true, ""}</code> –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, <code>{false, "User already exists"}</code> ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª.</li>
<li><b><code>std::unordered_map&lt;std::string, std::string&gt; GetAllUsers()</code></b> <br  />
 –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏–º—è ‚Üí —Ö–µ—à).</li>
<li><b><code>std::optional&lt;<a class="el" href="structpostgres_1_1_user_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.">postgres::UserRecord</a>&gt; FindUserByName(const std::string&amp; username)</code></b> <br  />
 –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏.</li>
<li><b><code>std::optional&lt;<a class="el" href="structpostgres_1_1_user_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.">postgres::UserRecord</a>&gt; FindUserById(const <a class="el" href="namespacepostgres.html#aa48112bc565b189d8c5e7f15584c474f" title="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.">postgres::UserId</a>&amp; id)</code></b> <br  />
 –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ id.</li>
<li><b><code>bool DeleteUserByName(const std::string&amp; username)</code></b> <br  />
 –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∏–º–µ–Ω–∏. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code>true</code>, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –±—ã–ª —É–¥–∞–ª—ë–Ω.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md8"></a>
–ö–æ–º–Ω–∞—Ç—ã</h2>
<ul>
<li><b><code>std::pair&lt;bool, std::string&gt; AddRoomToDB(const std::string&amp; room_name)</code></b> <br  />
 –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã. <code>{false, "Room already exists"}</code> ‚Äî –µ—Å–ª–∏ –∫–æ–º–Ω–∞—Ç–∞ —É–∂–µ –µ—Å—Ç—å.</li>
<li><b><code>std::optional&lt;<a class="el" href="structpostgres_1_1_room_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –∫–æ–º–Ω–∞—Ç—ã.">postgres::RoomRecord</a>&gt; FindRoomByName(const std::string&amp; room_name)</code></b> <br  />
 –ü–æ–∏—Å–∫ –∫–æ–º–Ω–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∏.</li>
<li><b><code>std::pair&lt;bool, std::string&gt; DeleteRoomByName(const std::string&amp; room_name)</code></b> <br  />
 –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∏.</li>
<li><b><code>std::vector&lt;<a class="el" href="structpostgres_1_1_room_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –∫–æ–º–Ω–∞—Ç—ã.">postgres::RoomRecord</a>&gt; GetAllRooms()</code></b> <br  />
 –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–æ–º–Ω–∞—Ç—ã.</li>
<li><b><code>std::vector&lt;<a class="el" href="structpostgres_1_1_room_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –∫–æ–º–Ω–∞—Ç—ã.">postgres::RoomRecord</a>&gt; GetRoomsPage(int offset, int limit)</code></b> <br  />
 –ü–∞–≥–∏–Ω–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É –∫–æ–º–Ω–∞—Ç (offset, limit).</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md10"></a>
–£—á–∞—Å—Ç–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–∞—Ö</h2>
<ul>
<li><b><code>std::pair&lt;bool, std::string&gt; AddUserToRoomByName(const std::string&amp; username, const std::string&amp; roomname)</code></b> <br  />
 –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–º–Ω–∞—Ç—É –ø–æ –∏–º–µ–Ω–∞–º.</li>
<li><b><code>std::vector&lt;<a class="el" href="structpostgres_1_1_user_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.">postgres::UserRecord</a>&gt; GetRoomMembersByName(const std::string&amp; roomname)</code></b> <br  />
 –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Å–æ—Å—Ç–æ—è—â–∏—Ö –≤ –∫–æ–º–Ω–∞—Ç–µ (–ø–æ –∏–º–µ–Ω–∏ –∫–æ–º–Ω–∞—Ç—ã).</li>
<li><b><code>std::pair&lt;bool, std::string&gt; RemoveUserFromRoomByName(const std::string&amp; username, const std::string&amp; roomname)</code></b> <br  />
 –£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –∫–æ–º–Ω–∞—Ç—ã –ø–æ –∏–º–µ–Ω–∞–º.</li>
</ul>
<hr  />
<h2><a class="anchor" id="autotoc_md12"></a>
–°–æ–æ–±—â–µ–Ω–∏—è</h2>
<ul>
<li><b><code>std::pair&lt;bool, std::string&gt; AddMessage(const std::string&amp; username, const std::string&amp; roomname, const std::string&amp; text)</code></b> <br  />
 –î–æ–±–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–º–Ω–∞—Ç—É.</li>
<li><b><code>std::vector&lt;<a class="el" href="structpostgres_1_1_message_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è.">postgres::MessageRecord</a>&gt; GetRecentMessages(const std::string&amp; roomname, int max_items)</code></b> <br  />
 –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ N —Å–æ–æ–±—â–µ–Ω–∏–π –∫–æ–º–Ω–∞—Ç—ã (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É).</li>
<li><b><code>std::vector&lt;<a class="el" href="structpostgres_1_1_message_record.html" title="–°—Ç—Ä—É–∫—Ç—É—Ä–∞, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—â–∞—è –∑–∞–ø–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è.">postgres::MessageRecord</a>&gt; GetRoomMessagesPage(const std::string&amp; roomname, int offset, int limit)</code></b> <br  />
 –ü–æ–ª—É—á–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∫–æ–º–Ω–∞—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.</li>
<li><b><code>bool DeleteMessageById(const <a class="el" href="namespacepostgres.html#a6635918d618a3980d1b04bdfd605da59" title="–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è.">postgres::MessageId</a>&amp; id)</code></b> <br  />
 –£–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ id.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md14"></a>
üí° –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è</h1>
<div class="fragment"><div class="line"><a class="code hl_class" href="class_i_r_c_d_b_wrapper.html">IRCDBWrapper</a> db(<span class="stringliteral">&quot;host=localhost dbname=test_db user=test_user password=test_password&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ---</span></div>
<div class="line">db.AddUserToDB(<span class="stringliteral">&quot;vasya&quot;</span>, <span class="stringliteral">&quot;pass_hash&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> user = db.FindUserByName(<span class="stringliteral">&quot;vasya&quot;</span>);</div>
<div class="line"><span class="keywordflow">if</span> (user) std::cout &lt;&lt; user-&gt;username &lt;&lt; std::endl;</div>
<div class="line">db.DeleteUserByName(<span class="stringliteral">&quot;vasya&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- –ö–æ–º–Ω–∞—Ç—ã ---</span></div>
<div class="line">db.AddRoomToDB(<span class="stringliteral">&quot;main&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> room = db.FindRoomByName(<span class="stringliteral">&quot;main&quot;</span>);</div>
<div class="line">db.DeleteRoomByName(<span class="stringliteral">&quot;main&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> all_rooms = db.GetAllRooms();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- –£—á–∞—Å—Ç–∏–µ –≤ –∫–æ–º–Ω–∞—Ç–∞—Ö ---</span></div>
<div class="line">db.AddUserToDB(<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;hash&quot;</span>);</div>
<div class="line">db.AddRoomToDB(<span class="stringliteral">&quot;general&quot;</span>);</div>
<div class="line">db.AddUserToRoomByName(<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;general&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> members = db.GetRoomMembersByName(<span class="stringliteral">&quot;general&quot;</span>);</div>
<div class="line">db.RemoveUserFromRoomByName(<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;general&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- –°–æ–æ–±—â–µ–Ω–∏—è ---</span></div>
<div class="line">db.AddMessage(<span class="stringliteral">&quot;alice&quot;</span>, <span class="stringliteral">&quot;general&quot;</span>, <span class="stringliteral">&quot;–ü—Ä–∏–≤–µ—Ç, —á–∞—Ç!&quot;</span>);</div>
<div class="line"><span class="keyword">auto</span> msgs = db.GetRecentMessages(<span class="stringliteral">&quot;general&quot;</span>, 10);</div>
<div class="line"><span class="keywordflow">if</span> (!msgs.empty()) std::cout &lt;&lt; msgs[0].message &lt;&lt; std::endl;</div>
<div class="line"><span class="keywordflow">if</span> (!msgs.empty()) db.DeleteMessageById(msgs[0].<span class="keywordtype">id</span>);</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md16"></a>
üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è</h1>
<ul>
<li>–í—Å–µ –º–µ—Ç–æ–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –ø–∞—Ä—É <code>{ok, error}</code> –ª–∏–±–æ <code>std::optional</code>, —á—Ç–æ–±—ã –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—à–∏–±–∫–∏ –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—ä–µ–∫—Ç–∞.</li>
<li>–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–æ–±—â–µ–Ω–∏–π), –≤—Å—Ç–∞–≤–ª—è–π—Ç–µ –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π, –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–∞–∑–Ω—ã–π timestamp (–∞–∫—Ç—É–∞–ª—å–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏).</li>
<li>–ü–∞—Ä–æ–ª–∏ –¥–æ–ª–∂–Ω—ã –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è <b>–≤ –≤–∏–¥–µ —Ö–µ—à–∞</b> (–Ω–∞–ø—Ä–∏–º–µ—Ä, SHA256), –∞ –Ω–µ –æ—Ç–∫—Ä—ã—Ç—ã–º —Ç–µ–∫—Å—Ç–æ–º!</li>
<li>–í–∞–∂–Ω–æ: –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ, —á—Ç–æ–±—ã –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –∫–æ–º–Ω–∞—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–ª–∏—Å—å –≤—Å–µ –∏—Ö —Å–æ–æ–±—â–µ–Ω–∏—è ‚Äî –≤ –≤–∞—à–µ–π –ë–î –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤–Ω–µ—à–Ω–∏–µ –∫–ª—é—á–∏ —Å <code>ON DELETE CASCADE</code>.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md18"></a>
üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h1>
<ul>
<li>–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–∞–π–ª <code>test_postgres.cpp</code> ‚Äî –æ–Ω –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –≤—Å–µ –º–µ—Ç–æ–¥—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –∏ <a class="el" href="class_i_r_c_d_b_wrapper.html" title="–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –º–µ—Ç–æ–¥—ã –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö IRC, –≤–∫–ª—é—á–∞—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏,...">IRCDBWrapper</a>, –≤–∫–ª—é—á–∞—è:<ul>
<li>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–æ–∏—Å–∫, —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∫–æ–º–Ω–∞—Ç</li>
<li>–î–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤/–∏–∑ –∫–æ–º–Ω–∞—Ç</li>
<li>–í—Å—Ç–∞–≤–∫—É, –ø–æ–ª—É—á–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π</li>
<li>–ü–∞–≥–∏–Ω–∞—Ü–∏—é –∏ –ø—Ä–æ–≤–µ—Ä–∫—É —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏</li>
</ul>
</li>
<li>–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –º–µ–∂–¥—É –≤—Å—Ç–∞–≤–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞–π—Ç–µ –ø–∞—É–∑—É (<code>std::this_thread::sleep_for</code>).</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md20"></a>
üìÇ –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h1>
<ul>
<li><code><a class="el" href="db__wrapper_8h.html" title="–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –∫–ª–∞—Å—Å–∞ IRCDBWrapper, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—â–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω...">db_wrapper.h</a>/.cpp</code> ‚Äî –æ–±—ë—Ä—Ç–∫–∞ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞</li>
<li><code><a class="el" href="postgres_8h.html" title="–ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö PostgreSQL.">postgres.h</a>/.cpp</code> ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞</li>
<li><code>test_postgres.cpp</code> ‚Äî –∞–≤—Ç–æ—Ç–µ—Å—Ç—ã</li>
<li><code>README_irc_chat_db.md</code> ‚Äî –æ–±—â–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ë–î IRC-—á–∞—Ç–∞</li>
</ul>
<hr  />
 </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
