<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>IRC-Chat: IRC Chat Project ‚Äî Docker Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">IRC-Chat<span id="projectnumber">&#160;Release</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md__r_e_a_d_m_e___d_o_c_k_e_r.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">IRC Chat Project ‚Äî Docker Guide</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md22"></a></p>
<h1><a class="anchor" id="autotoc_md23"></a>
üê≥ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker Compose</h1>
<h2><a class="anchor" id="autotoc_md24"></a>
1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –∫–∞—Ç–∞–ª–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞</h2>
<div class="fragment"><div class="line">git clone &lt;your_repo_url&gt;</div>
<div class="line">cd &lt;your_project_folder&gt;</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md25"></a>
2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª <code>.env</code> —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–ª—è –ë–î</h2>
<p>–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ <code>.env</code> (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è!): </p><div class="fragment"><div class="line">POSTGRES_USER=chat_user</div>
<div class="line">POSTGRES_PASSWORD=–û—á–µ–Ω—å_—Å–ª–æ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å</div>
<div class="line">POSTGRES_DB=irc_chat</div>
<div class="line"> </div>
<div class="line">IRC_CHAT_DB_URL=host=postgres dbname=irc_chat user=chat_user password=–û—á–µ–Ω—å_—Å–ª–æ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å</div>
<div class="line">IRC_CHAT_TEST_DB_URL=host=postgres dbname=irc_chat_test user=chat_user password=–û—á–µ–Ω—å_—Å–ª–æ–∂–Ω—ã–π_–ø–∞—Ä–æ–ª—å</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p><b>–í–∞–∂–Ω–æ:</b> —Ñ–∞–π–ª <code>.env</code> –¥–æ–ª–∂–µ–Ω –ª–µ–∂–∞—Ç—å –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –Ω–µ –ø–æ–ø–∞–¥–∞—Ç—å –≤ git (–¥–æ–±–∞–≤—å—Ç–µ <code>.env</code> –≤ <code>.gitignore</code>). </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md26"></a>
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞</h2>
<p>–í –∫–∞—Ç–∞–ª–æ–≥–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å:</p><ul>
<li><code>docker-compose.yml</code></li>
<li><code>Dockerfile</code></li>
<li><code>.env</code></li>
<li>–∏—Å—Ö–æ–¥–Ω–∏–∫–∏ (—Å–µ—Ä–≤–µ—Ä, —Ç–µ—Å—Ç—ã, etc.)</li>
<li>(–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) <code>wait-for-it.sh</code> –∏–ª–∏ –∞–Ω–∞–ª–æ–≥ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–∏—Å–æ–≤</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
4. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –∏ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</h2>
<div class="fragment"><div class="line">docker compose up --build</div>
</div><!-- fragment --><p> –ü–µ—Ä–≤–∞—è —Å–±–æ—Ä–∫–∞ –∑–∞–π–º–µ—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏, –¥–∞–ª–µ–µ –±—É–¥–µ—Ç –±—ã—Å—Ç—Ä–µ–µ –∑–∞ —Å—á–µ—Ç –∫—ç—à–∞. <br  />
 –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ç–µ—Å—Ç–æ–≤ —Å–æ–±–µ—Ä—É—Ç—Å—è –∏ —Å—Ç–∞—Ä—Ç—É—é—Ç. <br  />
 –ü–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç–µ—Å—Ç–æ–≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä <code>dbtests</code> –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è.</p>
<h2><a class="anchor" id="autotoc_md28"></a>
5. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏</h2>
<div class="fragment"><div class="line">docker compose logs server</div>
<div class="line">docker compose logs dbtests</div>
<div class="line">docker compose logs postgres</div>
</div><!-- fragment --><p> –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–µ–∂–∏—Ö –ª–æ–≥–æ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏: </p><div class="fragment"><div class="line">docker compose logs -f server</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md29"></a>
6. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å–µ—Ä–≤–µ—Ä –∏ –ë–î</h2>
<div class="fragment"><div class="line">docker compose up --build server postgres</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md30"></a>
7. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã</h2>
<div class="fragment"><div class="line">docker compose up --build dbtests</div>
</div><!-- fragment --><p> –õ–æ–≥–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ —Å–º–æ—Ç—Ä–∏—Ç–µ —á–µ—Ä–µ–∑: </p><div class="fragment"><div class="line">docker compose logs dbtests</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md31"></a>
8. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã</h2>
<div class="fragment"><div class="line">docker compose down</div>
</div><!-- fragment --><p> –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (–ø–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å volume –∏ –ë–î –∑–∞–Ω–æ–≤–æ): </p><div class="fragment"><div class="line">docker compose down -v</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md32"></a>
9. –í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä—É—á–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏</h2>
<div class="fragment"><div class="line">docker compose run --rm server /bin/bash</div>
</div><!-- fragment --><p> –∏–ª–∏ </p><div class="fragment"><div class="line">docker compose exec postgres psql -U chat_user -d irc_chat</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md33"></a>
10. –ò–∑–º–µ–Ω–∏–ª–∏ –∫–æ–¥? –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ!</h2>
<div class="fragment"><div class="line">docker compose up --build</div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md35"></a>
üß© –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã</h1>
<ul>
<li>–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –±–∞–∑—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –∫–æ–º–∞–Ω–¥–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞: <div class="fragment"><div class="line">command: [&quot;/bin/sh&quot;, &quot;-c&quot;, &quot;export PGPASSWORD=$POSTGRES_PASSWORD &amp;&amp; sleep 10 &amp;&amp; psql -U $POSTGRES_USER -h postgres -d postgres -c &#39;CREATE DATABASE irc_chat_test;&#39; || true &amp;&amp; ./build/DbTests&quot;]</div>
</div><!-- fragment --></li>
<li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ —Å —Ç–µ—Å—Ç–∞–º–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω <code>postgresql-client</code> (–≤ Dockerfile): <div class="fragment"><div class="line">RUN apt-get update &amp;&amp; apt-get install -y postgresql-client</div>
</div><!-- fragment --></li>
<li>–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –æ–∂–∏–¥–∞–Ω–∏—è (<code>wait-for-it.sh</code>), –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ –æ–±—Ä–∞–∑ –∏ –≤ –∫–æ–º–∞–Ω–¥—É –∑–∞–ø—É—Å–∫–∞.</li>
<li>–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ <code>.env</code> –¥–æ–ª–∂–Ω—ã —Å–æ–≤–ø–∞–¥–∞—Ç—å –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md37"></a>
üö© –ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è</h1>
<ul>
<li><b>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–Ω–∞:</b> <br  />
 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è —á–µ—Ä–µ–∑ <code>psql</code> –∏ —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø—Ä–æ–∫–∏–Ω—É—Ç—ã.</li>
<li><b>"connection refused":</b> <br  />
 –ó–Ω–∞—á–∏—Ç, —Å–µ—Ä–≤–µ—Ä —Å—Ç–∞—Ä—Ç—É–µ—Ç —Ä–∞–Ω—å—à–µ –ë–î. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∑–∞–¥–µ—Ä–∂–∫—É –∏–ª–∏ <code>wait-for-it</code>.</li>
<li><b>Config file not found:</b> <br  />
 –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Ä–µ–∞–ª—å–Ω–æ –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è (–∏–ª–∏ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è volume) –≤ Dockerfile –∏ –µ–≥–æ –ø—É—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç <code>WORKDIR</code>.</li>
<li><b>psql: not found:</b> <br  />
 –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–∞–∫–µ—Ç <code>postgresql-client</code> –≤ Dockerfile –¥–ª—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md39"></a>
üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è CI/CD</h1>
<ul>
<li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ <code>.env.example</code> –¥–ª—è —à–∞–±–ª–æ–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.</li>
<li>–•—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –æ—Ç–¥–µ–ª—å–Ω–æ –∏ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ —Ä–∞–±–æ—á–∏–µ –ø–∞—Ä–æ–ª–∏.</li>
<li>–î–ª—è –¥–µ–ø–ª–æ—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ volume –∏ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ init-—Å–∫—Ä–∏–ø—Ç—ã –∏–ª–∏ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã.</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md41"></a>
üõ† –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏</h1>
<ul>
<li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: <div class="fragment"><div class="line">docker compose run dbtests env | grep IRC_CHAT</div>
</div><!-- fragment --></li>
<li>–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞: <div class="fragment"><div class="line">docker compose run server ls -l /app/data/config.json</div>
</div><!-- fragment --></li>
<li>–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –ë–î –≤—Ä—É—á–Ω—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏): <div class="fragment"><div class="line">docker compose exec postgres psql -U chat_user -c &#39;CREATE DATABASE irc_chat_test;&#39;</div>
</div><!-- fragment --></li>
</ul>
<blockquote class="doxtable">
<p>–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç ‚Äî –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è! </p>
</blockquote>
<hr  />
<h1><a class="anchor" id="autotoc_md43"></a>
üìö –°—Å—ã–ª–∫–∏</h1>
<ul>
<li><a href="https://docs.docker.com/compose/">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Docker Compose</a></li>
<li><a href="https://hub.docker.com/_/postgres">–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è PostgreSQL Docker</a></li>
<li><a href="https://github.com/vishnubob/wait-for-it">wait-for-it</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
